# 变更提案: 修复伤害统计不准确（高伤害值解析）

## 需求背景
当前插件在部分战斗场景下出现伤害统计偏低/偏差，表现为高伤害技能（例如暴击、LB 或高威力技能）与游戏日志展示值不一致，进而导致总伤害与 DPS 统计不准确。

结合卫月 MCP 的日志窗口数据可观察到大量单次伤害值超过 65535（16-bit 上限）。插件当前对 `ActionEffectHandler.Effect` 的伤害值解码依赖 `Param4` 的标记位，当该标记在不同类型的伤害 effect/不同版本下不稳定时，可能导致高位未被合并，从而把 24-bit 伤害截断为 16-bit，造成统计偏低。

## 变更内容
1. 调整 ActionEffect 伤害值解码：对伤害类 effect 直接合并 `Param3` 高位，避免依赖 `Param4` 标记位导致的截断。
2. 保持现有事件过滤、暴击/直击统计、DoT 采集链路不变，确保改动最小且可回滚。
3. 同步更新知识库文档，记录最新解码口径与验证方法。

## 影响范围
- **模块:** core
- **文件:**
  - `DalamudACT/ACT2.cs`
  - `helloagents/wiki/modules/core.md`
  - `helloagents/CHANGELOG.md`
- **API:** 无
- **数据:** 无

## 核心场景

### 需求: 高伤害值统计准确
**模块:** core
插件统计的单次伤害、总伤害、DPS 与游戏内日志窗口一致（至少在数值层面不出现 16-bit 截断）。

#### 场景: 单次伤害超过 65535
在团本/木桩等环境出现单次伤害 > 65535 的技能命中时：
- 插件记录的该次伤害值与游戏日志展示一致
- 总伤害不再因高伤害被截断而显著偏低

## 风险评估
- **风险:** 若未来 FFXIV 对伤害 effect 字段语义再变更，盲目合并高位可能引入误差。
- **缓解:** 改动限制在“伤害类 effect（Damage/Blocked/Parried）”且仅合并 `Param3 << 16`；如发现误差，可快速回滚到旧逻辑或增加版本条件分支。
